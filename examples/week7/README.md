# 注意事項


## 反應力小遊戲的計時

在做第一題的時候，有許多人對於計時這一塊都用了一個 `setInterval` 去跑，然後設成每 10 毫秒每一次之類的。

但這方法其實行不通，而且誤差會很大。

為什麼呢？因為儘管你設成 10 毫秒，JS 也不一定會精準地在 10 毫秒以後執行你的 function。只能保證「至少 10 毫秒」，所以有可能其實是在 200 毫秒以後才去執行。

雖然這是之後才會上到的內容，但大家也可以先看一下：[What the heck is the event loop anyway? | Philip Roberts | JSConf EU](https://www.youtube.com/watch?v=8aGhZQkoFbQ)，裡面有提到 setTimeout 是怎麼運作的，看完你可能就會知道為什麼沒辦法「保證 10 毫秒」之後執行了。

那比較好的方法應該是什麼？

就是紀錄變色的時間點，還有紀錄點擊的時間點，你把兩個時間點相減就是反應時間了。

## 捕獲與冒泡

可能是之前沒有講得很清楚，有些人會對捕獲與冒泡有一個誤解。那就是以為你可以透過 `addEventListener` 的第三個參數來「改變」先捕獲還是先冒泡，例如說傳 true 就會先捕獲，反之則會先冒泡之類的。

這邊強調一下，捕獲與冒泡是「無論如何」都會發生的，而且順序永遠不會改變的一個東西。當你點擊某個按鈕時，就會先從 window 一路把事件傳遞下去，再從按鈕一路把事件傳遞回來。

所以，儘管你什麼 event listener 都沒有加，背後的捕獲與冒泡還是存在。

但存在歸存在，你卻感覺不到，因為你沒有加上監聽器（listener）！大概就像是你的床或枕頭可能有一堆塵蟎，但直到你用什麼很厲害的儀器觀察之前你都不會特別注意到，但不代表他們不存在。

事件機制也是這樣的，捕獲跟冒泡這個流程永遠都在，但如果你沒有加監聽器，你是察覺不到的。所以 addEventListener 的第三個參數只是覺得你要在「哪邊」加上這個監聽器，而不是改變原本事件傳遞的流程。

## 多用 class，少直接改變 style

在用 JS 去操作 DOM 又想要改變畫面上的 style 的時候，很多人都會很直覺地直接寫下 `node.style.xxx = xxx` 這種程式碼。這樣當然可以，但其實有更好的做法。

更好的作法就是你先把改變後要的 style 寫到 css 裡面，然後寫成一個新的 class，在 JS 裡面你就只要新增這個 class 上去就好。

舉例來說：

``` css
.btn-disable {
  color: white;
  background: black;
  cursor: none;
}
```

好處有幾個，第一個是方便觀察。

照以前的寫法，如果你想觀察某個狀態下的按鈕長什麼樣子，你只能再跑一次 JS，觸發到程式碼內改變 style 的地方。但是用 class 的話，你只要自己把這個元素加上 class 就可以看到它長什麼樣子了。

第二個好處是好維護。

當你要改變 style 的時候你只要改 css 就好，不需要再去改 JS。

再來，程式碼看起來也會乾淨很多，不會再有一大堆 JS 去改變 style。

相似的概念也可以用在一些元素的新增跟隱藏，有時候畫面要出現某個東西時你可能會用 JS 來新增，例如說這週反應力遊戲的「再玩一次」按鈕，你可能會用動態新增的方式。

但其實仔細想想，你可以先把這個按鈕寫好，然後用 `display: none` 藏起來，等遊戲結束時你只要把這個按鈕顯現出來就好！或者是融合我們上面所說的，把按鈕加上一個 `hide` 的 class，在遊戲結束時你只要：`btn.classList.remove('hide')`，按鈕就會顯示出來了，這樣程式碼乾淨很多。


## 程式的狀態儲存

我看到有滿多人都喜歡用 HTML 上面的元素來做一些判斷，或者是用 class 本身，例如說變色之後可能幫背景加上一個 `bg-changed` 的 class，然後點畫面時根據背景有沒有這個 class 來決定變色了沒。

這其實都是很奇怪的做法，如果沒有一個好的理由，你不該用 HTML 元素的狀態或者是 class 去判斷現在程式的狀態。原因是，你有 JS 的變數可以用，而這邊是最適合儲存程式狀態的地方。

例如說你可以宣告一個變數叫做 `isBackgroundChanged` 來取代上面的 class 的判斷，這樣子才能把介面跟邏輯給切開，介面歸介面，邏輯歸邏輯，政治歸政治，忍者龜忍者（？）。

一但把這些東西混在一起，當你要做改動的時候就會痛苦萬分。所以請大家慢慢學著程式邏輯相關的東西就是寫在 JS，就算你要多宣告一個變數也無妨，其實程式碼反而還會更容易讀。

其實上一點講的也是，只是是把 style 跟 JS 切開，透過 CSS 跟 class 把兩者連結在一起。


